<!DOCTYPE html>
<html lang="en">
<head>
    <link href="//db.onlinewebfonts.com/c/d7e8a95865396cddca89b00080d2cba6?family=SoDo+Sans+SemiBold" rel="stylesheet"
        type="text/css" />
    <!--使用者介面 根據手機電腦螢幕縮放-->
    <meta name="viewport", content="width=device-width, initial-scale=1.0">
    <title>Drivetrain-FRC6191 programming</title>
    <link rel="stylesheet", href="style.css">
</head>
<body>
    <div class="navbar-up">
        <figure class="alignleft size-large is-resized below-entry-meta">
            <img loading="lazy" data-attachment-id="374" data-permalink="https://team6191.wordpress.com/cropped-team-6191_the-emerald2-png/" data-orig-file="https://team6191.files.wordpress.com/2018/06/cropped-team-6191_the-emerald2.png" data-orig-size="512,512" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="cropped-team-6191_the-emerald2.png" data-image-description="<p>https://team6191.files.wordpress.com/2018/06/cropped-team-6191_the-emerald2.png</p>
            " data-image-caption="" data-medium-file="https://team6191.files.wordpress.com/2018/06/cropped-team-6191_the-emerald2.png?w=300" data-large-file="https://team6191.files.wordpress.com/2018/06/cropped-team-6191_the-emerald2.png?w=512" src="https://team6191.files.wordpress.com/2018/06/cropped-team-6191_the-emerald2.png?w=512" alt="" class="wp-image-374" width="40" height="40" srcset="https://team6191.files.wordpress.com/2018/06/cropped-team-6191_the-emerald2.png?w=40 40w, https://team6191.files.wordpress.com/2018/06/cropped-team-6191_the-emerald2.png?w=80 80w" sizes="(max-width: 40px) 100vw, 40px"></figure>
            <a href="FRC6191.html">team6191|programming</a>
    </div>
    <div class="wrap">
            <div class="navbar-link">
                <ul>
                    <i><li>疑難雜症</li></i>
                    <ul>
                        <li><a href="problems.html">RoboRIO</a></li>
                        <li><a href="problems.html">PDP</a></li>
                        <li><a href="">motor controller</a></li>
                    </ul>
                    <i><li>Drivetrain</li></i>
                    <ul>
                        <!--#跳到指定id-->
                        <li><a href="#arcadeDrive">Arcade Drive</a></li>
                        <li><a href="#mecanum">Mecanum Drive</a></li>
                        <li><a href="">H-Drive</a></li>
                    </ul>
                    <i><li>CommandBase</li></i>
                <ul>
                    <li><a href="">Subsystem</a></li>
                    <li><a href="">Command</a></li>
                </ul>
                <i><li>Gyro</li></i>
                <ul>

                </ul>
                <i><li>Vision Processing</li></i>
                <ul>
                    
                </ul>
                </ul>
            </div>
     <!--Drivetrain-->
    <div class="content">
        <section class="arcadeDrive">
                <h1 id="arcadeDrive">Arcade Drive</h1>
                <p>宣告方式為DifferentDrive(leftmotorcontroller, rightmotorcontroller)。
                    函式為arcadeDrive(forward, turn)。範例如下：</p>
            <pre>
                <code>
                   <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Robot</span> <span style="color: #008800; font-weight: bold">extends</span> TimedRobot <span style="color: #333333">{</span>
                        <span style="color: #008800; font-weight: bold">private</span> <span style="color: #008800; font-weight: bold">final</span> WPI_TalonFX left <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> WPI_TalonFX<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">);</span>
                        <span style="color: #008800; font-weight: bold">private</span> <span style="color: #008800; font-weight: bold">final</span> WPI_TalonFX right <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> WPI_TalonFX<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">);</span>
    
                        <span style="color: #008800; font-weight: bold">private</span> <span style="color: #008800; font-weight: bold">final</span> Joystick m_stick <span style="color: #333333">=</span> Joystick<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">);</span>
    
                        <span style="color: #008800; font-weight: bold">private</span> <span style="color: #008800; font-weight: bold">final</span> DifferentialDrive m_drive <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> DifferentialDrive<span style="color: #333333">(</span>left<span style="color: #333333">,</span> right<span style="color: #333333">);</span>
    
                        <span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">robotInit</span><span style="color: #333333">()</span> <span style="color: #333333">{</span>
                            
                        <span style="color: #333333">}</span>
    
                        <span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">teleopPeriodic</span><span style="color: #333333">()</span> <span style="color: #333333">{</span>
                            m_drive<span style="color: #333333">.</span><span style="color: #0000CC">arcadeDrive</span><span style="color: #333333">(-</span>m_stick<span style="color: #333333">.</span><span style="color: #0000CC">getRawAxis</span><span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">),</span> m_stick<span style="color: #333333">.</span><span style="color: #0000CC">getRawAxis</span><span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">));</span>
                        <span style="color: #333333">}</span>
</pre></td></tr></table></div>

 
                </code>
            </pre>

            <div class="tips1">
                Note:
                1.  第2, 3行：必須宣告成WPI_TalonSRX, WPI_TalonFX，才能放進DifferentialDrive。但如果是一般用途，宣告成
                    TalonSRX, TalonFX即可。
                2.  第7行：DifferentialDrive裡放底盤的左右兩邊馬達控制器。如果遇上兩邊多於一顆馬達，使用<span style="color: crimson;">follow()</span>
                    或是<span style="color: crimson;">SpeedControllerGroup()</span>就可以將多顆馬達綁住。
                3.  第14行：FRC網站上寫.getY(), .getX()，但使用.getRawAxis(1), .getRawAxis(0)比較好(經驗)，可以上網查或是用
                    driver station查看Joystick腳位。
            </div>
        </section>

        <section class="mecanum">
                <h1 id="mecanum">Mecanum Drive</h1>
                <div class="intro">
                    <section class="text">
                        1. 了解mecanum運作原理後自己寫。
                        2. 使用WPILib函式：<span style="color: crimson;"> driveCartesian()</span> <a href="https://github.com/wpilibsuite/allwpilib/blob/main/wpilibjExamples/src/main/java/edu/wpi/first/wpilibj/examples/mecanumdrive/Robot.java">官網範例程式</a> 
                        3. 使用WPILib函式：<span style="color: crimson;"> MecanumDriveOdometry</span> class <a href="https://github.com/wpilibsuite/allwpilib/tree/main/wpilibjExamples/src/main/java/edu/wpi/first/wpilibj/examples/mecanumbot">官網範例程式</a> 
                        下面程式是我們自己寫的：
                    </section>
                   <img src="https://gm0.org/en/latest/_images/mecanum-drive-directions.png" jsaction="VQAsE" class="r48jcc pT0Scc iPVvYb" style="max-width: 963px; height: 315px; margin: 0px; width: 302px;" alt="Programming Tutorial - Mecanum Drivetrain - Game Manual 0" jsname="kn3ccd" aria-hidden="false">
                </div>
                <pre>
                    <code>
                        <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Robot</span> <span style="color: #008800; font-weight: bold">extends</span> TimedRobot <span style="color: #333333">{</span>
  <span style="color: #008800; font-weight: bold">private</span> <span style="color: #008800; font-weight: bold">static</span> <span style="color: #008800; font-weight: bold">final</span> <span style="color: #333399; font-weight: bold">int</span> kFrontLeftChannel <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">;</span>
  <span style="color: #008800; font-weight: bold">private</span> <span style="color: #008800; font-weight: bold">static</span> <span style="color: #008800; font-weight: bold">final</span> <span style="color: #333399; font-weight: bold">int</span> kRearLeftChannel <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">;</span>
  <span style="color: #008800; font-weight: bold">private</span> <span style="color: #008800; font-weight: bold">static</span> <span style="color: #008800; font-weight: bold">final</span> <span style="color: #333399; font-weight: bold">int</span> kFrontRightChannel <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">3</span><span style="color: #333333">;</span>
  <span style="color: #008800; font-weight: bold">private</span> <span style="color: #008800; font-weight: bold">static</span> <span style="color: #008800; font-weight: bold">final</span> <span style="color: #333399; font-weight: bold">int</span> kRearRightChannel <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">;</span>

  <span style="color: #008800; font-weight: bold">private</span> <span style="color: #008800; font-weight: bold">static</span> <span style="color: #008800; font-weight: bold">final</span> <span style="color: #333399; font-weight: bold">int</span> kJoystickChannel <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span>

  <span style="color: #008800; font-weight: bold">private</span> Joystick m_stick <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Joystick<span style="color: #333333">(</span>kJoystickChannel<span style="color: #333333">);</span>
  
  <span style="color: #008800; font-weight: bold">private</span> <span style="color: #008800; font-weight: bold">final</span> WPI_TalonFX  frontLeft <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> WPI_TalonFX<span style="color: #333333">(</span>kFrontLeftChannel<span style="color: #333333">);</span>
  <span style="color: #008800; font-weight: bold">private</span> <span style="color: #008800; font-weight: bold">final</span> WPI_TalonFX rearLeft <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> WPI_TalonFX<span style="color: #333333">(</span>kRearLeftChannel<span style="color: #333333">);</span>
  <span style="color: #008800; font-weight: bold">private</span> <span style="color: #008800; font-weight: bold">final</span> WPI_TalonFX frontRight <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> WPI_TalonFX<span style="color: #333333">(</span>kFrontRightChannel<span style="color: #333333">);</span>
  <span style="color: #008800; font-weight: bold">private</span> <span style="color: #008800; font-weight: bold">final</span> WPI_TalonFX rearRight <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> WPI_TalonFX<span style="color: #333333">(</span>kRearRightChannel<span style="color: #333333">);</span>

<span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">teleopPeriodic</span><span style="color: #333333">()</span> <span style="color: #333333">{</span>
    <span style="color: #888888">// Use the joystick X axis for lateral movement, Y axis for forward</span>
    <span style="color: #888888">// movement, and Z axis for rotation.</span>
    
   
    <span style="color: #333399; font-weight: bold">double</span> vertical <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> <span style="color: #888888">//forward and backward</span>
    <span style="color: #333399; font-weight: bold">double</span> horizontal <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> <span style="color: #888888">//left and right </span>
    <span style="color: #333399; font-weight: bold">double</span> pivot <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> <span style="color: #888888">//turn</span>

    vertical <span style="color: #333333">=</span> <span style="color: #333333">-</span>m_stick<span style="color: #333333">.</span><span style="color: #0000CC">getRawAxis</span><span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">)</span> <span style="color: #333333">*</span> <span style="color: #6600EE; font-weight: bold">2000.0</span> <span style="color: #333333">*</span> <span style="color: #6600EE; font-weight: bold">2048.0</span> <span style="color: #333333">/</span> <span style="color: #6600EE; font-weight: bold">600.0</span><span style="color: #333333">;</span>
    horizontal <span style="color: #333333">=</span> <span style="color: #333333">-</span>m_stick<span style="color: #333333">.</span><span style="color: #0000CC">getRawAxis</span><span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">)</span> <span style="color: #333333">*</span> <span style="color: #6600EE; font-weight: bold">2000.0</span> <span style="color: #333333">*</span> <span style="color: #6600EE; font-weight: bold">2048.0</span> <span style="color: #333333">/</span> <span style="color: #6600EE; font-weight: bold">600.0</span><span style="color: #333333">;</span>
    pivot <span style="color: #333333">=</span> m_stick<span style="color: #333333">.</span><span style="color: #0000CC">getRawAxis</span><span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">)</span> <span style="color: #333333">*</span> <span style="color: #6600EE; font-weight: bold">2000.0</span> <span style="color: #333333">*</span> <span style="color: #6600EE; font-weight: bold">2048.0</span> <span style="color: #333333">/</span> <span style="color: #6600EE; font-weight: bold">600.0</span><span style="color: #333333">;</span>

    frontRight<span style="color: #333333">.</span><span style="color: #0000CC">set</span><span style="color: #333333">(</span>ControlMode<span style="color: #333333">.</span><span style="color: #0000CC">Velocity</span><span style="color: #333333">,</span> <span style="color: #333333">((-</span>pivot <span style="color: #333333">+</span> <span style="color: #333333">(</span>vertical <span style="color: #333333">+</span> horizontal<span style="color: #333333">))*</span><span style="color: #6600EE; font-weight: bold">0.5</span><span style="color: #333333">));</span>
    rearRight<span style="color: #333333">.</span><span style="color: #0000CC">set</span><span style="color: #333333">(</span>ControlMode<span style="color: #333333">.</span><span style="color: #0000CC">Velocity</span><span style="color: #333333">,</span> <span style="color: #333333">((-</span>pivot <span style="color: #333333">+</span> <span style="color: #333333">(</span>vertical <span style="color: #333333">-</span> horizontal<span style="color: #333333">))*</span><span style="color: #6600EE; font-weight: bold">0.5</span><span style="color: #333333">));</span>
    frontLeft<span style="color: #333333">.</span><span style="color: #0000CC">set</span><span style="color: #333333">(</span>ControlMode<span style="color: #333333">.</span><span style="color: #0000CC">Velocity</span><span style="color: #333333">,</span> <span style="color: #333333">((</span>pivot <span style="color: #333333">+(</span>vertical <span style="color: #333333">-</span> horizontal<span style="color: #333333">))*</span><span style="color: #6600EE; font-weight: bold">0.5</span><span style="color: #333333">));</span>
    rearLeft<span style="color: #333333">.</span><span style="color: #0000CC">set</span><span style="color: #333333">(</span>ControlMode<span style="color: #333333">.</span><span style="color: #0000CC">Velocity</span><span style="color: #333333">,</span> <span style="color: #333333">((</span>pivot <span style="color: #333333">+</span> <span style="color: #333333">(</span>vertical <span style="color: #333333">+</span> horizontal<span style="color: #333333">))*</span><span style="color: #6600EE; font-weight: bold">0.5</span><span style="color: #333333">));</span>
    
  <span style="color: #333333">}</span>
<span style="color: #333333">}</span>
</pre></td></tr></table></div>

                    </code>
                </pre>
                <div class="tips">
                    Note:
                    1. <span style="color: crimson;"> .driveCartesian()</span>只是基本讓馬達轉動，較粗糙。我們那時候沒成功，說不定是因為沒有宣告成WPI_TalonFX。
                    2. <span style="color: crimson;"> MecanumDriveOdometry</span> class 較進階，程式碼難理解但是駕駛者好操作，有自動校正
                    （曾經成功一次之後就沒有再成功過，<s>一定是因為陳雅君離開</s>）
                    3. 第25到27行 <a href="https://www.chiefdelphi.com/t/shooting-in-rpm-using-talon-fx/380660">轉速計算</a>
                    4. 第29到32行的<span style="color: crimson;"> ControlMode.Velocity</span>後面數值放轉速，與我們常用的<span style="color: crimson;"> ControlMode.Velocity</span>不同
                </div>
                


        </section>
    </div>    
    </div>
</body>
</html>